Muchas correcciones de errores y mejoras de rendimiento.

